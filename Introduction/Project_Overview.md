# SUSTECH-CS207-PROJECT: 基于FPGA的矩阵计算器

## 一、项目概述

本项目旨在设计并实现一个基于FPGA的矩阵计算器电路。该电路需支持基于矩阵的生成、展示、矩阵运算等功能（矩阵维度默认上限为 $5 \times 5$），通过开发板上的基础输入输出设备及 UART 串口实现与用户及系统的数据交互。

---

## 二、核心功能

系统开机后进入主菜单供用户选择具体功能：
1. 矩阵输入及存储
2. 矩阵生成及存储
3. 矩阵展示
4. 矩阵运算

每种模式结束后可以选择继续停留在该模式下，也可以选择返回到主菜单。
“矩阵运算”功能下可以选择具体的运算类型，一种运算结束后可以选择继续当前运算类型，或者切换到其他运算类型，或者切换到主菜单。

系统采用开发板的拨码开关、按键开关以及 Uart 串口通信软件做输入，采用开发板的 LED、7段数码显示管以及 Uart 串口通信软件做输出。

> **说明**：本系统中涉及到的矩阵，如未做特别说明，以维度为 $m \times n$ 的矩阵 A 为例，$m$ 和 $n$ 为 1~5 之间的整数；矩阵元素的值为 0~9 之间的整数。

### 2.1 输入输出处理

#### 2.1.1 输入
1.  **功能选择**：用开发板的拨码开关和按键。比如拨码开关上设置系统的工作模式，按键用作“确认键”。
2.  **数据输入**：用户在 Uart 传输软件上输入矩阵相关信息，比如矩阵维度、矩阵元素，点击软件上的“发送”将数据送给系统。
    > **说明**：如 Uart 功能未实现，使用键盘实现相同方式的输入则视为等价，不扣分。

#### 2.1.2 输出
1.  **开发板的 LED 灯及数码管**：对用户输入的矩阵、用户选择的运算数进行合法性检测，发现错误点亮一盏 LED 灯，如果没有错误则熄灭该 LED 灯，倒计时信息同步显示在 7 段数码显示管。
2.  **Uart 传输软件的接收窗口**：矩阵运算的运算数、运算结果，都通过 Uart 输出到 Uart 传输软件，在该软件上进行展示。
    > **说明**：如 Uart 功能未实现，使用 VGA 实现相同格式的输出则视为等价，不扣分。

---

### 2.2 矩阵输入、生成及存储

> **说明**：系统支持每种规格的矩阵最多存储 $x$ 个（$x$ 可配置，默认为 2）。系统支持的矩阵 $A(m \times n)$，$m$ 和 $n$ 的值可配置，默认为 1~5 之间的整数。

#### 2.2.1 支持用户输入矩阵并存储矩阵

1.  **用户输入**：用户在输入矩阵时应先输入矩阵的维度，再按先行后列的方式遍历输入每个矩阵元素的值。以维度为 $m \times n$ 的矩阵 A 为例，应先输入 $m$，再输入 $n$，最后输入 $A_{ij}$ ($i$ 从 0 到 $m-1$， $i$ 值确定时 $j$ 的值从 0 到 $n-1$)。
    * 例如，用户输入一个 $2 \times 3$ 的矩阵，发送窗口中的数据以及对应矩阵如下表所示（无需在接收窗口显示该矩阵）。

| 发送窗口的输入数据 | 生成的矩阵 |
| :--- | :--- |
| `23456789` | 4 5 6 <br> 7 8 9 |

2.  **系统检测**：
    * **(1) 维度范围**：如果用户输入的维度超出限制（1~5之间），则点亮检测报错 LED 灯，需要用户重新输入。
    * **(2) 矩阵元素的数值范围**：如果用户输入的数组元素超出 0~9 的范围，则点亮检测报错 LED 灯，需要用户重新输入。
    * **(3) 矩阵元素的个数**：
        * 如果用户输入的数组元素的数量不足，比如矩阵规模是 $2 \times 3$，但用户只输入了 4 个数据，则这 4 个数据被依次当作矩阵元素 $A_{00}, A_{01}, A_{02}, A_{10}$，将 $A_{11}, A_{12}$ 赋值为 0。
        * 如果用户输入的数组元素的个数超出指定范围，比如矩阵规模是 $2 \times 3$，用户输入了 8 个矩阵元素，则只取前 6 个矩阵元素的值，第 7、8 个输入的矩阵元素不作数。

#### 2.2.2 支持根据用户的指定生成矩阵并存储

用户在输入矩阵时应先输入矩阵的维度（以维度为 $m \times n$ 的矩阵 A 为例，先输入 $m$ 再输入 $n$）、矩阵的个数（不超过 2 个），再按先行后列的方式遍历生成每个矩阵元素的值。

例如，用户输入 `132`（如下表左侧所示），表示需要产生 2 个 $1 \times 3$ 的矩阵 A 和 B。电路因此生成 6 个随机数 `826579`，则 A、B 如下表右侧所示。

> **请注意**：使用递增或递减的方式产生的数字不是随机数，不得分。

| 用户输入 | 矩阵 A | 矩阵 B |
| :--- | :--- | :--- |
| `132` | 8 2 6 | 5 7 9 |

#### 2.2.3 系统存储矩阵

系统可以存储用户输入的矩阵、系统根据用户指定生成的矩阵以及矩阵的编号（编号方式由设计者自行设计并在系统里实现，不由用户输入指定）。
每种规格的矩阵最多存储 $x$ ($x$ 的值默认为 2) 个，如果同种类型的矩阵已存储了 $x$ 个，再输入相同规格的矩阵，则新输入的矩阵覆盖原来的矩阵。应保证原存储的矩阵可能被新输入的相同规格的矩阵全部覆盖，比如原来有 A, B，新输入 C 时覆盖了 A，再新输入 D 时覆盖 B。

---

### 2.3 矩阵展示

需以清晰方式展示矩阵，例如下图中，元素之间以空格、换行间隔，也可采用其他展示方式，需清晰并保证用户体验；一次展示多个矩阵时从上到下依次展示。

比如：输出一个 $2 \times 3$ 的矩阵 `A{{4, 5, 6}, {7, 8, 9}}`，Uart 通信助手的接收窗口显示如下所示：
```text
4 5 6
7 8 9